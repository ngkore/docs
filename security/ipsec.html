<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Understanding IPsec: How Internet Security Works" />
<meta property="og:type" content="website" />
<meta property="og:url" content="security/ipsec.html" />
<meta property="og:site_name" content="NgKore" />
<meta property="og:description" content="Hello there, crypto commandos! Remember those old-school spy gadgets from James Bond movies where everything needed a secret handshake and decoder ring? Well, today we’re diving into IPsec — the pr..." />
<meta property="og:image" content=".sphinx/_static/tag.png" />
<meta property="og:image:alt" content="NgKore" />
<meta name="description" content="Hello there, crypto commandos! Remember those old-school spy gadgets from James Bond movies where everything needed a secret handshake and decoder ring? Well, today we’re diving into IPsec — the pr..." />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="QUIC: The Future of Internet Transport" href="quic.html" /><link rel="prev" title="Can 5G SUPI Concealment really ensure Forward Secrecy?" href="supi.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Understanding IPsec: How Internet Security Works - NgKore Docs</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/youtube.css" />
    <link rel="stylesheet" type="text/css" href="../_static/related-links.css" />
    <link rel="stylesheet" type="text/css" href="../_static/terminal-output.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f84bc4ab" />
    <link rel="stylesheet" type="text/css" href="../_static/header.css?v=23b7cbea" />
    <link rel="stylesheet" type="text/css" href="../_static/github_issue_links.css?v=be107c51" />
    <link rel="stylesheet" type="text/css" href="../_static/furo_colors.css?v=0eedd8e7" />
    
</head>
  <body>
    <header id="header" class="p-navigation">

  <div class="p-navigation__nav" role="menubar">

    <ul class="p-navigation__links" role="menu">

      <li>
        <a class="p-logo" href="https://github.com/ngkore" aria-current="page">
          <img src="../_static/tag.png" alt="Logo" class="p-logo-image">
          <!-- <div class="p-logo-text p-heading--4">NgKore
          </div> -->
        </a>
      </li>


    </ul>
    <!-- Add your website link here -->
    <a href="https://ngkore.org" target="_blank" class="p-header-link">
      NgKore.org
    </a>
  </div>
</header>
   
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">NgKore Docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">NgKore Docs</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../kernel-bypass/index.html">Kernel Bypass Mechanisms</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Kernel Bypass Mechanisms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/af_xdp.html">AF_XDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/dpdk.html">DPDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/sriov.html">SR-IOV</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../oran/index.html">O-RAN</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of O-RAN</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part1.html">Challenges in L1-L2 Interoperability within O-RAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part2.html">Understanding xFAPI: Bridging L1 and L2 Layers of O-RAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part3.html">Open RAN (O-RAN) Interoperability with xFAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/smo-qoe-prediction.html">QoE Prediction Using AI/ML Framework in Distributed ORAN Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/smo-uav-path-preduction.html">UAV Path Prediction Using AI/ML Framework in Distributed ORAN Architecture</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ebpf/index.html">eBPF</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of eBPF</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-meets-5g.html">eBPF Meets 5G: Transforming User Plane Function for Next-Gen Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/hexaebpf.html">HEXAeBPF: The Future of Interoperable eBPF Defined 5G Core (eDC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf.html">eBPF : Unveiling the Future of Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-maps.html">The Magic of eBPF Maps: Building a High-Performance Rate Limiter Without Touching User Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/xdp-ebpf.html">Unlocking Network Performance with XDP and eBPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-cuda.html">Inside CUDA: Building eBPF uprobes for GPU Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-gpu.html">The Silent Revolution: eBPF Is Hacking Your GPU (For Good)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-monitoring.html">Building an eBPF Process Monitor with Go: A Step-by-Step Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-network-detective.html">eBPF: The Network Detective</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/ebpf-ssd.html">Your SSD Is About to Get Superpowers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/l4-lb.html">Load Balancing at Light Speed:</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5g-operator/index.html">5G Core Operator</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 5G Core Operator</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../5g-operator/ngkore_operator.html">NgKore Operator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../l3af/index.html">L3AF</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of L3AF</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../l3af/l3af.html">L3AF Integration with 5G-UPF</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Networking and Security</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Networking and Security</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tls.html">TLS/SSL Connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="supi.html">Can 5G SUPI Concealment really ensure Forward Secrecy?</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Understanding IPsec: How Internet Security Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="quic.html">QUIC: The Future of Internet Transport</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ntn/index.html">NTN</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of NTN</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ntn/ntn1.html">Introduction to NTN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/ntn2.html">OAI NTN Part 1: Breaking the Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/p1-of-5.html">From Ground to Space: The 5G Revolution Above the Clouds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/p2-of-5.html">Space Giants: Who’s Building the Internet in the Sky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/dtn.html">Delay-Tolerant Networks (DTNs): Networking Beyond Earth</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../pqc/index.html">PQC</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of PQC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pqc/pqc-intro.html">Introduction To Post-Quantum Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pqc/oqs-lib.html">Working of Open Quantum Safe Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pqc/quantum-proof-algo.html">Learning with Errors: Quantum-Proof Algorithm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5g/index.html">5G Core</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 5G Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../5g/5g-upf.html">5G UPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5g/rewrite-upf.html">Rewiring the 5G Data Plane: XDP/eBPF in the Fast Lane of UPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5g/os-5g-compare.html">Understanding Open-Source 5G Core Network Evolution in 2025</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ai/index.html">AI/ML</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of AI/ML</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ai/ai-gpu.html">The Hidden Army: How AI Training Actually Happens Across Thousands of GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai/route-phone-call.html">The AI Traffic Cops: How Machine Learning Routes Your Phone Calls in Real-Time</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/security/ipsec.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="understanding-ipsec-how-internet-security-works">
<h1>Understanding IPsec: How Internet Security Works<a class="headerlink" href="#understanding-ipsec-how-internet-security-works" title="Link to this heading">¶</a></h1>
<p>Hello there, crypto commandos! Remember those old-school spy gadgets from James Bond movies where everything needed a secret handshake and decoder ring? Well, today we’re diving into IPsec — the protocol suite that basically gave every packet on the internet its own secret agent credentials. If you thought your password manager was paranoid, wait until you see what IPsec does to secure every single byte traveling across cyberspace.</p>
<p>For those digital warriors who’ve been riding this security wave with me, today we’re exploring the protocol framework that’s been silently protecting internet communications since the dawn of secure networking. Buckle up, because we’re about to uncover how IPsec turned the wild west of the early internet into a militarized zone of encrypted tunnels and authenticated packets!</p>
<section id="what-is-ipsec">
<h2>What is IPsec?<a class="headerlink" href="#what-is-ipsec" title="Link to this heading">¶</a></h2>
<p>IPsec (Internet Protocol Security) is a comprehensive protocol suite designed to secure Internet Protocol communications at the network layer. Rather than being a single protocol, IPsec functions as a security framework that provides authentication, integrity, and confidentiality for IP packets.</p>
<p>Operating at Layer 3 of the OSI model, IPsec can secure any type of IP traffic without requiring modifications to existing applications. This network-layer approach means that once IPsec is configured, all applications automatically benefit from its protection — web browsing, email, file transfers, and custom protocols all get secured transparently.</p>
<p>IPsec achieves security through two primary mechanisms: Authentication Header (AH) for integrity and authentication, and Encapsulating Security Payload (ESP) for encryption and authentication. These protocols work in conjunction with Internet Key Exchange (IKE) to establish secure communications channels called Security Associations.</p>
<p>The protocol suite maintains security state information in two key databases: the Security Association Database (SAD) stores active connection parameters including encryption keys and algorithms, while the Security Policy Database (SPD) determines which traffic requires IPsec protection and how that protection should be applied.</p>
<section id="how-does-ipsec-work">
<h3>How does IPsec work?<a class="headerlink" href="#how-does-ipsec-work" title="Link to this heading">¶</a></h3>
<p>IPsec connections include the following steps:</p>
<p><strong>Key exchange:</strong> IPsec sets up keys with a key exchange between the connected devices, so that each device can decrypt the other device’s messages.</p>
<p><strong>Packet headers and trailers:</strong> All data that is sent over a network is broken down into smaller pieces called packets. IPsec adds several headers to data packets containing authentication and encryption information. IPsec also adds trailers, which go after each packet’s payload instead of before.</p>
<blockquote>
<div><p>Note: Packet trailers are additional data appended to the end of a packet’s payload that contain control information such as integrity checksums, padding for encryption block alignment, and protocol-specific metadata needed for proper packet processing.</p>
</div></blockquote>
<p><strong>Authentication:</strong> IPsec provides authentication for each packet which ensures that packets are from a trusted source and not an attacker.</p>
<p><strong>Encryption:</strong> IPsec encrypts the payloads within each packet and each packet’s IP header (tunnel mode only). This keeps data sent over IPsec secure and private.</p>
<p><strong>Transmission:</strong> Encrypted IPsec packets travel across one or more networks to their destination using UDP as the transport protocol.</p>
<p><strong>Decryption:</strong> At the other end of the communication, the packets are decrypted, and applications (e.g. a browser) can now use the delivered data.</p>
</section>
<section id="why-use-udp-underneath">
<h3>Why use UDP Underneath?<a class="headerlink" href="#why-use-udp-underneath" title="Link to this heading">¶</a></h3>
<p>IPsec was originally designed to operate directly over IP using protocol numbers 50 (ESP) and 51 (AH). However, real-world deployment challenges led to the development of UDP encapsulation as a practical solution for middlebox (firewalls, load balancers, NATs) traversal.</p>
<blockquote>
<div><p>Note: A protocol number is a numerical identifier used to specify which protocol is being used within an IP packet. It’s a way for the receiving device to know how to interpret the data contained within the packet. Essentially, it tells the receiving end what kind of data is inside the IP packet (e.g., TCP, UDP, ICMP).</p>
</div></blockquote>
<p>The main challenges came from three types of network devices. NAT devices rewrite IP addresses and port numbers but can’t process IPsec packets that either encrypt port information (ESP) or don’t use ports at all (AH), causing connection failures. Firewalls often block unfamiliar traffic, and IPsec protocol numbers 50 and 51 are less understood than standard TCP/UDP protocols. Load balancers make forwarding decisions based on port numbers, but IPsec packets don’t provide this information in the expected format.</p>
<p><img alt="alt text" src="../_images/ipsec-middlebox.webp" /></p>
<p>IPsec uses UDP because this allows IPsec packets to get through firewalls and NAT devices more easily. TCP sets up dedicated connections between devices and ensures that all packets arrive, while UDP does not set up these dedicated connections. This makes UDP more suitable for IPsec encapsulation since it provides the transport layer information that middleboxes expect without the connection state complexity of TCP.</p>
<p><img alt="alt text" src="../_images/ipsec-upd.webp" /></p>
<p>UDP encapsulation, formalized as NAT Traversal (NAT-T), addresses these issues by wrapping IPsec packets in UDP headers. The encapsulated packets use UDP port 4500, which provides the transport layer information that middleboxes expect. NAT devices can rewrite the UDP header information while leaving the encapsulated IPsec data intact. Firewalls can apply standard UDP policies, and load balancers can distribute traffic based on UDP port information.</p>
<p><img alt="alt text" src="../_images/ipsec-nat.webp" /></p>
<blockquote>
<div><p>NAT-T (NAT Traversal) is a mechanism that allows IPsec traffic to pass through Network Address Translation devices by encapsulating IPsec packets within UDP headers, enabling the NAT device to track and translate the connection using standard UDP port information.</p>
</div></blockquote>
</section>
<section id="udp-encapsulation-call-flow-example">
<h3>UDP Encapsulation Call Flow Example<a class="headerlink" href="#udp-encapsulation-call-flow-example" title="Link to this heading">¶</a></h3>
<p>Let’s see how UDP encapsulation works with a practical example where a client in Delhi connects to a corporate server in California through a NAT device:</p>
<p><img alt="alt text" src="../_images/ipsec-upd-encap.webp" /></p>
<ol class="arabic simple">
<li><p><strong>Initial IKE Discovery:</strong> Client → Server: IKE packet on UDP port 500 containing vendor IDs and NAT detection payloads</p></li>
<li><p><strong>NAT Detection:</strong> Server compares received source IP/port with values inside encrypted payload; mismatch indicates NAT presence</p></li>
<li><p><strong>Port Switch Negotiation:</strong> Client ↔ Server: Both parties agree to switch from UDP port 500 to UDP port 4500 for all subsequent communication</p></li>
<li><p><strong>Encapsulated Data Flow:</strong> Client → NAT → Server: Original IPsec packet wrapped in UDP header with source/destination port 4500</p></li>
<li><p><strong>NAT Processing:</strong> NAT device rewrites UDP source IP and port while preserving the encapsulated IPsec payload</p></li>
<li><p><strong>Server Processing:</strong> Server receives UDP packet, strips UDP header, and processes the original IPsec content normally</p></li>
</ol>
<p>The NAT-T process includes several sophisticated mechanisms beyond simple UDP wrapping. During IKE negotiation, both parties detect whether NAT is present on the communication path by comparing hash values computed over IP address information. If the hashes differ between sender and receiver, NAT modification is detected and UDP encapsulation is activated.</p>
</section>
<section id="how-the-internet-worked-before-ipsec">
<h3>How the Internet Worked Before IPsec<a class="headerlink" href="#how-the-internet-worked-before-ipsec" title="Link to this heading">¶</a></h3>
<p>The original Internet Protocol (IP) was designed in an era of trusted networks where security was not a primary concern. When researchers and academics created IP in the 1970s and 1980s, the network consisted of a limited number of trusted institutions, and the primary focus was on connectivity and reliability rather than security.</p>
<p>In this original model, data transmission was straightforward but completely unprotected. Applications would create data, TCP would add reliability mechanisms, and IP would handle routing — all in plain text. This approach created several fundamental vulnerabilities including eavesdropping where any device could read packet contents, data tampering where traffic could be modified without detection, and identity spoofing where source addresses could be easily forged.</p>
<p>Early security solutions operated at the application layer, requiring each service to implement its own protection mechanisms. Email used PGP for encryption/Decryption, web traffic relied on TLS/SSL for protection, and remote access employed SSH for secure connections. This piecemeal approach meant that security coverage was inconsistent, with many protocols remaining completely unprotected.</p>
<blockquote>
<div><p>Note: PGP (Pretty Good Privacy) is a method for encrypting and decrypting emails to enhance their security and privacy.</p>
</div></blockquote>
<p>The fundamental issue was that security was treated as an add-on feature rather than a core network service. Each application had to reinvent security mechanisms, leading to implementation inconsistencies and gaps in protection. IPsec addressed these limitations by moving security down to the network layer itself, providing universal protection that all applications could benefit from automatically.</p>
</section>
<section id="what-protocols-does-ipsec-use">
<h3>What Protocols Does IPsec Use?<a class="headerlink" href="#what-protocols-does-ipsec-use" title="Link to this heading">¶</a></h3>
<p>IPsec employs a coordinated set of protocols that work together to provide comprehensive network security. At its core, IPsec uses two main security protocols: AH and ESP.</p>
<p><strong>Authentication Header (AH)</strong> provides data integrity and authentication services without encryption. AH computes a cryptographic hash over the entire IP packet using shared secret keys, creating an Integrity Check Value that proves the packet originated from the claimed sender and hasn’t been modified in transit. The protocol also includes sequence numbers to prevent replay attacks where old packets are retransmitted by attackers.</p>
<p><strong>Encapsulating Security Payload (ESP)</strong> offers both confidentiality through encryption and authentication through integrity checking. ESP encrypts the packet payload using symmetric encryption algorithms like AES, making the data unreadable to unauthorized parties. Additionally, ESP can provide the same integrity and authentication services as AH, often eliminating the need to use both protocols simultaneously.</p>
<p>AH and ESP both offer authentication and integrity but only ESP supports encryption. Because of this, ESP is the most popular choice nowadays.</p>
<p><strong>Security Associations (SAs)</strong> are fundamental data structures that define how IPsec protects traffic between communication peers. Each SA contains all the security parameters needed to process packets in one direction, including encryption algorithms, authentication methods, cryptographic keys, and sequence numbers for replay protection. IPsec requires separate SAs for each direction of communication, so a bidirectional connection uses two SAs.</p>
<p>The establishment and management of these Security Associations is handled by <strong>Internet Key Exchange (IKE)</strong>, which is one of the primary protocols within the SA framework. IKE authenticates the identities of communicating parties using certificates or pre-shared keys. It negotiates which encryption and authentication algorithms both parties will use, generates and distributes cryptographic keys securely, and manages key lifecycle including renewal and deletion.</p>
<p>IKE operates in two distinct phases:</p>
<ul class="simple">
<li><p><strong>Phase 1</strong> establishes a secure, encrypted tunnel for management communications and mutual authentication between peers. It can use either Main Mode (6 messages, higher security) or Aggressive Mode (3 messages, faster setup)</p></li>
<li><p><em>Phase 2</em> uses this secure tunnel to negotiate the actual IPsec parameters and create the Security Associations that will protect data traffic. It uses Quick Mode for efficient SA negotiation over the established secure tunnel</p></li>
</ul>
<blockquote>
<div><p>Note:</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">Main</span> <span class="n">Mode</span><span class="p">:</span><span class="o">*</span> <span class="n">It</span> <span class="ow">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">establish</span> <span class="n">a</span> <span class="n">secure</span> <span class="n">channel</span> <span class="p">(</span><span class="n">IKE</span> <span class="n">SA</span><span class="p">)</span> <span class="n">between</span> <span class="n">two</span> <span class="n">peers</span><span class="o">.</span> <span class="n">It</span> <span class="n">involves</span> <span class="n">a</span> <span class="n">series</span> <span class="n">of</span> <span class="mi">6</span> <span class="n">messages</span> <span class="n">exchanged</span> <span class="ow">in</span> <span class="n">three</span> <span class="n">pairs</span> <span class="n">to</span> <span class="n">negotiate</span> <span class="n">security</span> <span class="n">parameters</span> <span class="ow">and</span> <span class="n">authenticate</span> <span class="n">the</span> <span class="n">peers</span> <span class="n">then</span> <span class="n">exchanges</span> <span class="n">identity</span> <span class="n">information</span> <span class="n">only</span> <span class="n">after</span> <span class="n">encryption</span> <span class="ow">is</span> <span class="n">established</span><span class="o">.</span>

<span class="o">*</span><span class="n">Aggressive</span> <span class="n">Mode</span><span class="p">:</span><span class="o">*</span> <span class="n">it</span> <span class="n">involves</span> <span class="mi">3</span> <span class="n">message</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">a</span> <span class="n">faster</span> <span class="n">alternative</span> <span class="n">to</span> <span class="n">IKE</span> <span class="n">Main</span> <span class="n">Mode</span> <span class="n">but</span> <span class="n">at</span> <span class="n">the</span> <span class="n">cost</span> <span class="n">of</span> <span class="n">reduced</span> <span class="n">security</span><span class="o">.</span> <span class="n">It</span> <span class="n">sends</span> <span class="n">the</span> <span class="n">initiator</span> <span class="n">identity</span> <span class="ow">in</span> <span class="n">clear</span> <span class="n">text</span> <span class="n">potentially</span> <span class="n">exposing</span> <span class="n">it</span> <span class="n">to</span> <span class="n">attackers</span><span class="o">.</span>

<span class="o">*</span><span class="n">Quick</span> <span class="n">Mode</span><span class="p">:</span><span class="o">*</span> <span class="n">Uses</span> <span class="n">the</span> <span class="n">secure</span> <span class="n">Phase</span> <span class="mi">1</span> <span class="n">tunnel</span> <span class="n">to</span> <span class="n">quickly</span> <span class="n">negotiate</span> <span class="n">IPsec</span> <span class="n">parameters</span> <span class="n">without</span> <span class="n">repeating</span> <span class="n">the</span> <span class="n">heavy</span> <span class="n">authentication</span> <span class="n">process</span><span class="o">.</span>
</pre></div>
</div>
<p><em>The Security Association Database (SAD)</em> stores information about active security connections, including encryption keys, algorithm parameters, sequence numbers, and lifetime values. Each security association represents a one-way security relationship between two parties.</p>
<p><em>The Security Policy Database (SPD)</em> contains rules that determine how different types of traffic should be handled. The SPD specifies which traffic requires IPsec protection, what type of protection to apply, and what to do with traffic that doesn’t match any defined policies.</p>
<p>These components work together seamlessly. When an outbound packet needs protection, the SPD determines the required security treatment. If protection is needed but no suitable security association exists, IKE negotiates a new one and stores the results in the SAD. The appropriate security protocol (AH or ESP) then processes the packet according to the SAD parameters.</p>
</section>
<section id="ipsec-2-phase-handshake">
<h3>IPsec 2-Phase Handshake<a class="headerlink" href="#ipsec-2-phase-handshake" title="Link to this heading">¶</a></h3>
<p>IPsec establishes secure communications through a two-phase negotiation process, where each phase serves a distinct purpose in building the complete security framework.</p>
</section>
<section id="phase-1-ike-security-association-sa-establishment">
<h3>Phase 1: IKE Security Association (SA) Establishment<a class="headerlink" href="#phase-1-ike-security-association-sa-establishment" title="Link to this heading">¶</a></h3>
<p>In this phase, an ISAKMP (Internet Security Association and Key Management Protocol) session is established. This is also called the ISAKMP tunnel or IKE phase 1 tunnel.</p>
<p>Phase 1 creates a secure, authenticated channel that will be used for all subsequent negotiations. This phase typically uses IKE Main Mode, which involves six message exchanges between the initiator and responder.</p>
<p><img alt="alt text" src="../_images/ipsec-ike.webp" /></p>
<p><strong>Message 1:</strong> Initiator → Responder: “I want to establish a secure connection. Here are my supported security policies including encryption algorithms (AES-256, 3DES), authentication methods (PSK, certificates), hash algorithms (SHA-256, MD5), and Diffie-Hellman groups (Group 2, 14, 16) for key exchange”
<strong>Message 2:</strong> Responder → Initiator: “I accept your connection request. From your proposals, I choose AES-256 for encryption, SHA-256 for hashing, PSK for authentication, and DH Group 14 for key exchange”
<strong>Message 3:</strong> Initiator → Responder: “Here’s my Diffie-Hellman public key value and a random nonce number for replay protection.”
<strong>Message 4:</strong> Responder → Initiator: “Here’s my Diffie-Hellman public key value and nonce number. Now we both can calculate the same shared secret”
<strong>Message 5:</strong> Initiator → Responder: [Encrypted with derived keys] “My identity is Company-A-VPN-Gateway and here’s my authentication data (PSK hash or certificate) to prove I am who I claim to be”
<strong>Message 6:</strong> Responder → Initiator: [Encrypted with derived keys] “My identity is Company-B-VPN-Gateway and here’s my authentication data. Phase 1 tunnel is now established and secured”
The process begins when the initiator sends its security proposals, including supported encryption algorithms, authentication methods, and key exchange parameters. The responder selects one proposal from the offered options and replies with its choice. Both parties then exchange Diffie-Hellman public keys, which allows them to compute a shared secret without transmitting the secret itself across the network. Using this shared secret, they derive encryption and authentication keys for protecting Phase 1 communications. The final step involves exchanging and verifying identity information, such as digital certificates or pre-shared keys, over the newly encrypted channel.</p>
<p>Phase 1 results in an IKE Security Association that provides an encrypted, authenticated communication channel. This security association typically has a long lifetime, often measured in hours or days, since the identity verification process is computationally expensive.</p>
</section>
<section id="phase-2-ipsec-security-association-establishment">
<h3>Phase 2: IPsec Security Association Establishment<a class="headerlink" href="#phase-2-ipsec-security-association-establishment" title="Link to this heading">¶</a></h3>
<p>Phase 2 negotiates the actual data protection parameters using the secure channel established in Phase 1. This phase uses IKE Quick Mode, which requires only three message exchanges.</p>
<p><img alt="alt text" src="../_images/ipsec.webp" /></p>
<ul class="simple">
<li><p><strong>Message 1:</strong> Initiator → Responder: [Encrypted via Phase 1 tunnel] “For our data traffic, I propose ESP protocol with AES-128 encryption, SHA-1 authentication, tunnel mode operation, and protection for traffic from network 192.168.1.0/24 to 10.0.0.0/8. Here’s additional key material for perfect forward secrecy”</p></li>
<li><p><strong>Message 2:</strong> Responder → Initiator: [Encrypted via Phase 1 tunnel] “I accept your ESP proposal with AES-128, SHA-1, and tunnel mode for the specified traffic. Here’s my key material contribution. Our IPsec Security Parameter Index (SPI) will be 0x12345678 for your direction and 0x87654321 for my direction”</p></li>
</ul>
<blockquote>
<div><p>Note: The Security Parameter Index (SPI) is a 32-bit value used to uniquely identify a Security Association (SA) within an IPsec connection</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Message 3:</strong> Initiator → Responder: [Encrypted via Phase 1 tunnel] “Configuration confirmed. IPsec SAs are established and ready for data protection. Hash verification successful. Data encryption can now begin”</p></li>
</ul>
<p>The initiator proposes specific protection parameters for data traffic, including which IPsec protocol to use (ESP or AH), encryption and authentication algorithms, operational mode (tunnel or transport), and traffic selectors that define which packets should be protected. The responder agrees to the proposed parameters and both parties generate fresh key material for data protection. This key generation often involves another Diffie-Hellman exchange to ensure perfect forward secrecy, meaning that compromise of long-term keys won’t affect the security of individual data sessions.</p>
<p>Phase 2 creates IPsec Security Associations that are stored in the Security Association Database (SAD). These associations contain all information needed to encrypt and decrypt actual data traffic. Unlike Phase 1, these security associations typically have shorter lifetimes and are renewed frequently to maintain security.</p>
<p>The two-phase approach provides several technical advantages. Security separation ensures that identity verification and data protection use different keys and can have different security policies. Efficiency is achieved because the expensive identity verification only happens once, while lightweight data protection negotiations can occur multiple times. Perfect forward secrecy is maintained since each data session uses unique keys that are deleted after use.</p>
</section>
<section id="tunneling-vs-transport-mode">
<h3>Tunneling vs Transport Mode<a class="headerlink" href="#tunneling-vs-transport-mode" title="Link to this heading">¶</a></h3>
<p>IPsec offers two distinct operational modes that determine how security is applied to IP packets. The choice between tunnel and transport mode affects packet structure, routing behavior, and deployment scenarios.</p>
<section id="transport-mode">
<h4>Transport Mode<a class="headerlink" href="#transport-mode" title="Link to this heading">¶</a></h4>
<p>Transport mode applies IPsec protection to the payload of an IP packet while preserving the original IP header. In this mode, the IPsec header (ESP or AH) is inserted between the original IP header and the transport layer header (TCP or UDP). The original source and destination IP addresses remain visible, but the transport layer and application data are encrypted and authenticated.</p>
<p><strong>Packet Structure:</strong></p>
<p><em>For AH:</em></p>
<p><img alt="alt text" src="../_images/transport-ah.webp" /></p>
<p><em>For ESP:</em></p>
<p><img alt="alt text" src="../_images/transport-esp.webp" /></p>
<p><em>For AH+ESP:</em></p>
<p><img alt="alt text" src="../_images/transport-ah-esp.webp" /></p>
<p>When a packet is processed in transport mode, the original IP header guides routing decisions throughout the network. Network devices can apply quality of service policies based on the visible addressing information, and traffic analysis reveals the communication endpoints. However, the actual data exchange, including transport layer information and application content, remains protected from eavesdropping and tampering.</p>
<p>Transport mode is primarily used for end-to-end communications between two hosts that both support IPsec. This mode requires IPsec implementation on both endpoints and is commonly employed for securing specific application flows that need direct host-to-host protection.</p>
</section>
<section id="tunnel-mode">
<h4>Tunnel Mode<a class="headerlink" href="#tunnel-mode" title="Link to this heading">¶</a></h4>
<p>Tunnel mode encapsulates the entire original IP packet within a new IP packet. The original packet, including its headers, becomes the payload of a new IP packet with different source and destination addresses. This new outer header typically points to IPsec gateways or VPN endpoints rather than the original communication endpoints.</p>
<p><strong>Packet Structure:</strong></p>
<p><em>For AH:</em></p>
<p><img alt="alt text" src="../_images/transport-ah.webp" /></p>
<p><em>For ESP:</em></p>
<p><img alt="alt text" src="../_images/transport-esp.webp" /></p>
<p><em>For AH+ESP:</em></p>
<p><img alt="alt text" src="../_images/transport-ah-esp.webp" /></p>
<p>In tunnel mode processing, the complete original packet is encrypted and becomes the payload of the new packet. Network routing decisions are based on the outer IP header, which usually directs traffic between security gateways. The original communication endpoints are hidden within the encrypted payload, providing location privacy and enabling network-to-network communications.</p>
<p>Tunnel mode enables IPsec gateways to provide transparent security services for entire networks. Client systems and servers don’t need IPsec implementations since the security processing occurs at intermediate gateways. This approach allows existing applications and systems to benefit from IPsec protection without modification.</p>
<p>The packet structure differences have important implications for network behavior. Transport mode adds minimal overhead since only IPsec headers are added to existing packets. Tunnel mode creates larger packets due to the additional outer IP header, but provides complete traffic flow confidentiality.</p>
<p>And there you have it, fellow security architects! IPsec isn’t just another networking protocol — it’s the foundational technology that transformed the internet from an open playground into a secure communications platform. From its elegant two-phase handshake process to its clever UDP encapsulation tricks, IPsec has been quietly protecting our digital conversations for decades.</p>
<p>The beauty of IPsec lies in its comprehensive approach: operating at the network layer where it can protect everything automatically, providing both authentication and encryption in a single framework, and offering the flexibility to secure everything from individual applications to entire corporate networks.</p>
<p>Whether you’re building site-to-site VPNs, securing remote access, or just appreciating the invisible infrastructure that keeps our data safe, IPsec remains the heavyweight champion of network security. Now go forth and let your packets travel safely through their encrypted tunnels! 🔒</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
   

<div class="related-pages">
  
  
      
  
  
  
    
</div>
<div style="text-align:center; font-size:0.95em; margin-top:1em;">
  For any query please contact: <a href="mailto:contact@ngkore.org">contact@ngkore.org</a>
</div>
<div class="bottom-of-page">
  <div class="left-details">
    <!--
    <div class="copyright">
        Copyright &#169; 
    </div> -->

    

    <!--<div class="last-updated">
      Last updated on Jul 18, 2025</div> -->

    <!--
    <div class="show-source">
      <a class="muted-link" href="../_sources/security/ipsec.md.txt"
         rel="nofollow">Show source</a>
    </div> -->
  </div>
  <div class="right-details">

    

    <!--  -->

    <!--  -->


    </div>
  </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer">
      
<div class="toc-sticky toc-scroll">
   
    <div class="toc-title-container">
      <span class="toc-title">
       Contents
      </span>
    </div>
    <div class="toc-tree-container">
      <div class="toc-tree">
        <ul>
<li><a class="reference internal" href="#">Understanding IPsec: How Internet Security Works</a><ul>
<li><a class="reference internal" href="#what-is-ipsec">What is IPsec?</a><ul>
<li><a class="reference internal" href="#how-does-ipsec-work">How does IPsec work?</a></li>
<li><a class="reference internal" href="#why-use-udp-underneath">Why use UDP Underneath?</a></li>
<li><a class="reference internal" href="#udp-encapsulation-call-flow-example">UDP Encapsulation Call Flow Example</a></li>
<li><a class="reference internal" href="#how-the-internet-worked-before-ipsec">How the Internet Worked Before IPsec</a></li>
<li><a class="reference internal" href="#what-protocols-does-ipsec-use">What Protocols Does IPsec Use?</a></li>
<li><a class="reference internal" href="#ipsec-2-phase-handshake">IPsec 2-Phase Handshake</a></li>
<li><a class="reference internal" href="#phase-1-ike-security-association-sa-establishment">Phase 1: IKE Security Association (SA) Establishment</a></li>
<li><a class="reference internal" href="#phase-2-ipsec-security-association-establishment">Phase 2: IPsec Security Association Establishment</a></li>
<li><a class="reference internal" href="#tunneling-vs-transport-mode">Tunneling vs Transport Mode</a><ul>
<li><a class="reference internal" href="#transport-mode">Transport Mode</a></li>
<li><a class="reference internal" href="#tunnel-mode">Tunnel Mode</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

      </div>
    </div>
   
    
  </div>

    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/header-nav.js?v=e117ad08"></script>
    
<script>
  const github_url = "https://github.com/ngkore";
</script>
</body>
</html>