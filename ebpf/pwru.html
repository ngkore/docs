<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="PWRU: Debugging Packets and Kernel Flows" />
<meta property="og:type" content="website" />
<meta property="og:url" content="ebpf/pwru.html" />
<meta property="og:site_name" content="NgKore" />
<meta property="og:description" content="Introduction to eBPF: eBPF (Extended Berkeley Packet Filter) has dramatically changed how we observe, monitor, and interact with the Linux kernel. Originally designed for filtering packets, eBPF no..." />
<meta property="og:image" content=".sphinx/_static/tag.png" />
<meta property="og:image:alt" content="NgKore" />
<meta name="description" content="Introduction to eBPF: eBPF (Extended Berkeley Packet Filter) has dramatically changed how we observe, monitor, and interact with the Linux kernel. Originally designed for filtering packets, eBPF no..." />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="NTN" href="../ntn/index.html" /><link rel="prev" title="Load Balancing at Light Speed:" href="l4-lb.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>PWRU: Debugging Packets and Kernel Flows - NgKore Docs</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/youtube.css?v=4e28cee6" />
    <link rel="stylesheet" type="text/css" href="../_static/related-links.css?v=18806edd" />
    <link rel="stylesheet" type="text/css" href="../_static/terminal-output.css?v=4adfee69" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f84bc4ab" />
    <link rel="stylesheet" type="text/css" href="../_static/header.css?v=23b7cbea" />
    <link rel="stylesheet" type="text/css" href="../_static/github_issue_links.css?v=be107c51" />
    <link rel="stylesheet" type="text/css" href="../_static/furo_colors.css?v=0eedd8e7" />
    
</head>
  <body>
    <header id="header" class="p-navigation">

  <div class="p-navigation__nav" role="menubar">

    <ul class="p-navigation__links" role="menu">

      <li>
        <a class="p-logo" href="https://github.com/ngkore" aria-current="page">
          <img src="../_static/tag.png" alt="Logo" class="p-logo-image">
          <!-- <div class="p-logo-text p-heading--4">NgKore
          </div> -->
        </a>
      </li>


    </ul>
    <!-- Add your website link here -->
    <a href="https://ngkore.org" target="_blank" class="p-header-link">
      NgKore.org
    </a>
  </div>
</header>
   
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">NgKore Docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">NgKore Docs</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../pqc/index.html">PQC</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of PQC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pqc/pqc-intro.html">Introduction To Post-Quantum Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pqc/oqs-lib.html">Working of Open Quantum Safe Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pqc/quantum-proof-algo.html">Learning with Errors: Quantum-Proof Algorithm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../oran/index.html">O-RAN</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of O-RAN</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part1.html">Challenges in L1-L2 Interoperability within O-RAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part2.html">Understanding xFAPI: Bridging L1 and L2 Layers of O-RAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/xfapi-part3.html">Open RAN (O-RAN) Interoperability with xFAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/smo-qoe-prediction.html">QoE Prediction Using AI/ML Framework in Distributed ORAN Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oran/smo-uav-path-preduction.html">UAV Path Prediction Using AI/ML Framework in Distributed ORAN Architecture</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5g/index.html">5G Core</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 5G Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../5g/5g-upf.html">5G UPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5g/rewrite-upf.html">Rewiring the 5G Data Plane: XDP/eBPF in the Fast Lane of UPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5g/os-5g-compare.html">Understanding Open-Source 5G Core Network Evolution in 2025</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">eBPF</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of eBPF</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ebpf-meets-5g.html">eBPF Meets 5G: Transforming User Plane Function for Next-Gen Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="hexaebpf.html">HEXAeBPF: The Future of Interoperable eBPF Defined 5G Core (eDC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf.html">eBPF : Unveiling the Future of Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-maps.html">The Magic of eBPF Maps: Building a High-Performance Rate Limiter Without Touching User Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="xdp-ebpf.html">Unlocking Network Performance with XDP and eBPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-cuda.html">Inside CUDA: Building eBPF uprobes for GPU Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-gpu.html">The Silent Revolution: eBPF Is Hacking Your GPU (For Good)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-monitoring.html">Building an eBPF Process Monitor with Go: A Step-by-Step Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-network-detective.html">eBPF: The Network Detective</a></li>
<li class="toctree-l2"><a class="reference internal" href="ebpf-ssd.html">Your SSD Is About to Get Superpowers</a></li>
<li class="toctree-l2"><a class="reference internal" href="l4-lb.html">Load Balancing at Light Speed:</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">PWRU: Debugging Packets and Kernel Flows</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ntn/index.html">NTN</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of NTN</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ntn/ntn1.html">Introduction to NTN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/ntn2.html">OAI NTN Part 1: Breaking the Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/p1-of-5.html">From Ground to Space: The 5G Revolution Above the Clouds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/p2-of-5.html">Space Giants: Who’s Building the Internet in the Sky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ntn/dtn.html">Delay-Tolerant Networks (DTNs): Networking Beyond Earth</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ai/index.html">AI/ML</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of AI/ML</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ai/ai-gpu.html">The Hidden Army: How AI Training Actually Happens Across Thousands of GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai/route-phone-call.html">The AI Traffic Cops: How Machine Learning Routes Your Phone Calls in Real-Time</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../security/index.html">Networking and Security</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Networking and Security</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/tls.html">TLS/SSL Connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/supi.html">Can 5G SUPI Concealment really ensure Forward Secrecy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/ipsec.html">Understanding IPsec: How Internet Security Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/quic.html">QUIC: The Future of Internet Transport</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5g-operator/index.html">5G Core Operator</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 5G Core Operator</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../5g-operator/ngkore_operator.html">NgKore Operator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../kernel-bypass/index.html">Kernel Bypass Mechanisms</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Kernel Bypass Mechanisms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/af_xdp.html">AF_XDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/dpdk.html">DPDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-bypass/sriov.html">SR-IOV</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../l3af/index.html">L3AF</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of L3AF</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../l3af/l3af.html">L3AF Integration with 5G-UPF</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/ebpf/pwru.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pwru-debugging-packets-and-kernel-flows">
<h1>PWRU: Debugging Packets and Kernel Flows<a class="headerlink" href="#pwru-debugging-packets-and-kernel-flows" title="Link to this heading">¶</a></h1>
<section id="introduction-to-ebpf">
<h2>Introduction to eBPF<a class="headerlink" href="#introduction-to-ebpf" title="Link to this heading">¶</a></h2>
<p>eBPF (Extended Berkeley Packet Filter) has dramatically changed how we observe, monitor, and interact with the Linux kernel. Originally designed for filtering packets, eBPF now allows programs to run safely inside the Linux kernel without modifying source code or rebooting. These programs can hook into system events like networking, system calls, tracing, and security enforcement, enabling deep observability and control.</p>
<p>In the world of networking, eBPF offers powerful ways to trace, filter, and manipulate packet flows at various layers — from ingress to application delivery — with minimal overhead. One of the standout tools built using this technology is <strong>PWRU</strong>.</p>
</section>
<section id="what-is-pwru">
<h2>What is PWRU?<a class="headerlink" href="#what-is-pwru" title="Link to this heading">¶</a></h2>
<p>PWRU, short for “<strong>Packet, Where Are You?</strong>”, is an open-source, eBPF-based kernel packet tracer developed by the Cilium team. It helps network engineers, kernel developers, and observability enthusiasts trace packet movement <strong>across the entire Linux kernel network stack</strong>.</p>
<p>At its core, PWRU dynamically attaches <strong>kprobes</strong> to various kernel network functions, capturing packet events in real time without needing any kernel modifications. It can follow packets as they flow through interfaces, routing layers, firewalls, and socket layers — making it an invaluable tool for debugging complex networking issues.</p>
<p>In addition, PWRU leverages <strong>libpcap</strong> internally, enabling users to apply familiar <code class="docutils literal notranslate"><span class="pre">tcpdump</span></code>-style filters to trace only the packets they are interested in.</p>
</section>
<section id="how-does-pwru-work">
<h2>How Does PWRU Work?<a class="headerlink" href="#how-does-pwru-work" title="Link to this heading">¶</a></h2>
<p>To understand PWRU’s inner working, it’s important to first grasp two fundamental concepts: <strong>BTF (BPF Type Format)</strong> and <strong>kprobes</strong>. Linux kernels provide <strong>BTF</strong> information, which describes the types and structures used internally by the kernel (e.g., network packet structures, socket information). PWRU uses this BTF data — especially from the <code class="docutils literal notranslate"><span class="pre">vmlinux</span></code> file — to interpret network function arguments like <code class="docutils literal notranslate"><span class="pre">sk_buff</span></code> structures safely and correctly.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">vmlinux</span></code> file (often found at <code class="docutils literal notranslate"><span class="pre">/sys/kernel/btf/vmlinux</span></code>) contains a full symbol and structure map of the running kernel. PWRU uses it to automatically generate Go bindings (<code class="docutils literal notranslate"><span class="pre">vmlinux.h</span></code>) and understand how packets are structured inside the kernel memory.</p>
<p>This allows PWRU to trace deeply into kernel networking functions without writing any manual parsing code per kernel version — a huge advantage!</p>
</section>
<section id="bpf-programs-and-kprobes-in-pwru">
<h2>BPF Programs and kprobes in PWRU<a class="headerlink" href="#bpf-programs-and-kprobes-in-pwru" title="Link to this heading">¶</a></h2>
<p>PWRU’s main power lies in its <strong>dynamic tracing</strong>. It attaches <strong>eBPF programs</strong> at <strong>kprobe</strong> points — meaning it hooks into the entry of selected kernel functions.</p>
<ul class="simple">
<li><p>Whenever a packet hits a hooked network function (e.g., ip_rcv, tcp_v4_rcv), the attached eBPF program runs.</p></li>
<li><p>The eBPF program collects useful metadata: interface info, packet protocol, IP addresses, port numbers, etc.</p></li>
<li><p>This information is pushed into special <strong>BPF maps</strong> for collection and further processing in userspace (Go application).</p></li>
</ul>
<p>At every hook point, <strong>five different instances of BPF programs</strong> can be attached — each capturing different kinds of metadata and packet traces. This multi-hook design allows PWRU to provide a detailed, layered view of packet journeys inside the kernel.</p>
</section>
<section id="deep-dive-into-pwru-internals">
<h2>Deep Dive into PWRU Internals<a class="headerlink" href="#deep-dive-into-pwru-internals" title="Link to this heading">¶</a></h2>
<p>If you’re curious about the deeper technical details, here’s how PWRU captures and processes packet data internally:</p>
<p><strong>Key Data Structures</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">skb_meta</span></code>: Holds metadata like network namespace ID, mark value, interface index, packet length, MTU, and protocol.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code>: Stores 4-tuple information — source and destination IPs and ports (for TCP/UDP flows).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event_t</span></code>: Aggregates all relevant event data, including timestamps, sk_buff addresses, process IDs, and extracted metadata.</p></li>
</ul>
<p><strong>Important BPF Maps</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">events</span></code>: A ring buffer or perf event map used to push events to user space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skb_addresses</span></code>, <code class="docutils literal notranslate"><span class="pre">skb_stackid</span></code>, <code class="docutils literal notranslate"><span class="pre">stackid_skb</span></code>: Hash maps to track sk_buff lifecycle and stack traces.</p></li>
<li><p>print_stack_map: Stack trace map to store kernel stack traces.</p></li>
</ul>
<p><strong>Helper Functions</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_netns</span></code>(): Extracts network namespace of the packet.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter_meta</span></code>(): Applies filters based on namespace, mark, interface, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_meta</span></code>() and <code class="docutils literal notranslate"><span class="pre">set_tuple</span></code>(): Parse packet headers and populate metadata fields.</p></li>
</ul>
<p><strong>Filtering Mechanism</strong>:</p>
<ul class="simple">
<li><p>PWRU supports <strong>pcap-style filtering</strong> ( <code class="docutils literal notranslate"><span class="pre">filter_pcap_l3</span></code>, <code class="docutils literal notranslate"><span class="pre">filter_pcap_l2</span></code>) based on L2/L3 headers.</p></li>
<li><p>The main function <code class="docutils literal notranslate"><span class="pre">filter</span></code>() combines all these filters to decide if an event should be reported.</p></li>
</ul>
<p>A Go-based frontend application reads from these BPF maps, processes the raw events, formats them nicely, and displays them to users — allowing live monitoring of packet paths through the kernel stack.</p>
</section>
<section id="setting-up-pwru-prerequisites-installation-and-testing">
<h2>Setting up PWRU: Prerequisites, Installation, and Testing<a class="headerlink" href="#setting-up-pwru-prerequisites-installation-and-testing" title="Link to this heading">¶</a></h2>
<p>After understanding the internals of PWRU, let’s now move to setting it up on your own Linux system and start tracing packets!</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h3>
<p>Before building PWRU, you need to ensure a few essential packages and tools are installed on your system. These are required for compiling both the eBPF programs and the Go userspace application:</p>
<ul class="simple">
<li><p><strong>clang</strong> and <strong>llvm</strong></p></li>
<li><p>go</p></li>
<li><p>gcc</p></li>
<li><p>bison, byacc, yacc, flex</p></li>
<li><p>libpcap-dev</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt update</span>
<span class="go">sudo apt install -y clang llvm gcc make flex bison byacc yacc libpcap-dev golang</span>
</pre></div>
</div>
</section>
<section id="building-pwru-from-source">
<h3>Building PWRU from Source<a class="headerlink" href="#building-pwru-from-source" title="Link to this heading">¶</a></h3>
<p>Once all the prerequisites are installed, you can proceed to clone the PWRU repository and build it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Clone<span class="w"> </span>the<span class="w"> </span>PWRU<span class="w"> </span>GitHub<span class="w"> </span>repository
<span class="go">git clone https://github.com/cilium/pwru.git</span>
<span class="gp"># </span>Navigate<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>project<span class="w"> </span>directory
<span class="go">cd pwru</span>
<span class="gp"># </span>Build<span class="w"> </span>the<span class="w"> </span>project
<span class="go">make</span>
</pre></div>
</div>
<p>If everything is properly set up, the make command will:</p>
<ul class="simple">
<li><p>Compile the eBPF object files</p></li>
<li><p>Build the userspace Go application</p></li>
<li><p>Link everything together</p></li>
</ul>
<p>At the end of the process, you will find the <code class="docutils literal notranslate"><span class="pre">pwru</span></code> binary in the project root directory, ready to use!</p>
</section>
<section id="running-pwru">
<h3>Running PWRU<a class="headerlink" href="#running-pwru" title="Link to this heading">¶</a></h3>
<p>Since PWRU interacts directly with kernel functions and eBPF subsystems, you need <strong>root permissions</strong> to run it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">pwru</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="p">[</span><span class="n">pcap</span><span class="o">-</span><span class="nb">filter</span><span class="p">]</span>
</pre></div>
</div>
<p>PWRU accepts standard tcpdump -style filters at the command line to select which packets you want to trace.</p>
</section>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h3>
<p>Let’s trace <strong>ICMP</strong> (ping) packets traveling through the kernel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">pwru</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="nb">tuple</span> <span class="n">icmp</span>
</pre></div>
</div>
<p>This command instructs PWRU to:</p>
<ul class="simple">
<li><p>Focus on packets matching the ICMP protocol (Layer 4)</p></li>
<li><p>Print the associated source/destination IPs and ports in the output</p></li>
</ul>
<p>You will start seeing output like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">2025/04/26 12:34:14 Attaching kprobes (via kprobe-multi)...</span>
<span class="go">1642 / 1642 [----------------------------------------------------------------------------------------------------------------------------------] 100.00% ? p/s</span>
<span class="go">2025/04/26 12:34:14 Attached (ignored 0)</span>
<span class="go">2025/04/26 12:34:14 Listening for events..</span>
<span class="go">SKB                CPU PROCESS          NETNS      MARK/x        IFACE       PROTO  MTU   LEN   TUPLE FUNC</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) napi_gro_receive</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) dev_gro_receive</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) inet_gro_receive</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) napi_gro_receive</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) dev_gro_receive</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) inet_gro_receive</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) skb_defer_rx_timestamp</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) skb_defer_rx_timestamp</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) ip_rcv_core</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) ip_rcv_core</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) nf_hook_slow</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) nf_ip_checksum</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) __skb_checksum_complete</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) skb_ensure_writable</span>
<span class="go">0xffff99cf11aa4100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  58    192.168.6.1:0-&gt;192.168.6.236:0(icmp) nf_ip_checksum</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) nf_hook_slow</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) nf_ip_checksum</span>
<span class="go">0xffff99cf08de1100 0   &lt;empty&gt;:0        4026531840 0             eth0:2      0x0800 1500  68    192.168.6.1:0-&gt;192.168.6.236:0(icmp) __skb_checksum_complete</span>
</pre></div>
</div>
<p>Each row represents:</p>
<ul class="simple">
<li><p>A packet (<code class="docutils literal notranslate"><span class="pre">skb</span></code>) moving through the Linux kernel,</p></li>
<li><p>Along with metadata like which function (<code class="docutils literal notranslate"><span class="pre">FUNC</span></code>) it visited,</p></li>
<li><p>Which interface (<code class="docutils literal notranslate"><span class="pre">IFACE</span></code>) it came through,</p></li>
<li><p>Packet tuple details (src/dst IP, protocol, etc.).</p></li>
</ul>
<p>You can now <strong>observe the exact code path your packets follow</strong> — across functions like<br />
<code class="docutils literal notranslate"><span class="pre">napi_gro_receive()</span></code>, <code class="docutils literal notranslate"><span class="pre">dev_gro_receive(</span></code>), <code class="docutils literal notranslate"><span class="pre">inet_gro_receive()</span></code>, <code class="docutils literal notranslate"><span class="pre">ip_rcv_core()</span></code>, and so on.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>PWRU is a powerful tool for tracing the life of network packets inside the Linux kernel with <strong>minimal setup and zero code modifications</strong>. By dynamically attaching kprobes to key networking functions, PWRU gives deep visibility into:</p>
<ul class="simple">
<li><p>Where packets are processed,</p></li>
<li><p>How they move across different kernel subsystems,</p></li>
<li><p>And where delays, drops, or modifications happen.</p></li>
</ul>
<p>It is especially useful for <strong>debugging complex networking issues</strong>, understanding the kernel’s <strong>packet handling internals</strong>, or simply learning how Linux networking works under the hood.</p>
<p>With a simple installation process, standard tcpdump-style filters, and real-time output, PWRU makes kernel packet tracing <strong>accessible even to beginners</strong> while remaining powerful enough for advanced users.</p>
<p>Whether you are diagnosing performance problems, debugging kernel modules, or just exploring, <strong>PWRU gives you a microscope into the Linux networking stack.</strong></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
   

<div class="related-pages">
  
  
      
  
  
  
    
</div>
<div style="text-align:center; font-size:0.95em; margin-top:1em;">
  For any query please contact: <a href="mailto:contact@ngkore.org">contact@ngkore.org</a>
</div>
<div class="bottom-of-page">
  <div class="left-details">
    <!--
    <div class="copyright">
        Copyright &#169; 
    </div> -->

    

    <!--<div class="last-updated">
      Last updated on Jul 18, 2025</div> -->

    <!--
    <div class="show-source">
      <a class="muted-link" href="../_sources/ebpf/pwru.md.txt"
         rel="nofollow">Show source</a>
    </div> -->
  </div>
  <div class="right-details">

    

    <!--  -->

    <!--  -->


    </div>
  </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer">
      
<div class="toc-sticky toc-scroll">
   
    <div class="toc-title-container">
      <span class="toc-title">
       Contents
      </span>
    </div>
    <div class="toc-tree-container">
      <div class="toc-tree">
        <ul>
<li><a class="reference internal" href="#">PWRU: Debugging Packets and Kernel Flows</a><ul>
<li><a class="reference internal" href="#introduction-to-ebpf">Introduction to eBPF</a></li>
<li><a class="reference internal" href="#what-is-pwru">What is PWRU?</a></li>
<li><a class="reference internal" href="#how-does-pwru-work">How Does PWRU Work?</a></li>
<li><a class="reference internal" href="#bpf-programs-and-kprobes-in-pwru">BPF Programs and kprobes in PWRU</a></li>
<li><a class="reference internal" href="#deep-dive-into-pwru-internals">Deep Dive into PWRU Internals</a></li>
<li><a class="reference internal" href="#setting-up-pwru-prerequisites-installation-and-testing">Setting up PWRU: Prerequisites, Installation, and Testing</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#building-pwru-from-source">Building PWRU from Source</a></li>
<li><a class="reference internal" href="#running-pwru">Running PWRU</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

      </div>
    </div>
   
    
  </div>

    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/header-nav.js?v=e117ad08"></script>
    
<script>
  const github_url = "https://github.com/ngkore";
</script>
</body>
</html>